<html lang="id" class="scroll-smooth">
 <head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>Berita - PCNU Kotabaru</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;display=swap"
    rel="stylesheet"
  />
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: "Roboto", sans-serif;
    }
    /* Modal animation */
    .modal-enter {
      opacity: 0;
      transform: translateY(-20px);
    }
    .modal-enter-active {
      opacity: 1;
      transform: translateY(0);
      transition: opacity 300ms ease, transform 300ms ease;
    }
    .modal-exit {
      opacity: 1;
      transform: translateY(0);
    }
    .modal-exit-active {
      opacity: 0;
      transform: translateY(-20px);
      transition: opacity 300ms ease, transform 300ms ease;
    }
    /* Arabic text styling */
    .arabic-text {
      font-family: "Scheherazade New", "Amiri", "Lateef", serif;
      direction: rtl;
      unicode-bidi: embed;
      font-size: 1.25rem;
      line-height: 1.6;
      margin: 0.75rem 0;
    }
    /* Justify modal content */
    #modal-content {
      text-align: justify;
    }
    /* Hover effects */
    .news-card {
      transition: all 0.3s ease;
    }
    .news-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }
    .hover-button {
      transition: all 0.3s ease;
    }
    .hover-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .social-icon {
      transition: all 0.3s ease;
    }
    .social-icon:hover {
      transform: translateY(-3px);
      color: #4ade80 !important;
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Scheherazade+New&family=Amiri&family=Lateef&display=swap" rel="stylesheet" />
 </head>
 <body class="bg-gray-50 text-gray-800">
  <header class="bg-green-800 text-green-100 shadow-md fixed w-full z-30">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
     <div class="flex justify-between items-center h-16">
      <a class="flex items-center space-x-3" href="index.html">
        <img
        alt="Logo PCNU Kotabaru, green and gold emblem with Islamic calligraphy" 
        class="h-16 w-16 object-contain"
        height="64"
        src="img/logo.jpg"
        width="64"
       />
       <span class="text-2xl font-bold text-green-100">PCNU Kotabaru</span>
      </a>
      <nav class="hidden md:flex space-x-8 font-semibold text-green-100">
       <a 
         class="hover:text-green-300 transition" 
         href="index.html"
       >
         Beranda
       </a>
       <a 
         class="hover:text-green-300 transition" 
         href="tentang.html"
       >
         Tentang Kami
       </a>
       <a 
         class="hover:text-green-300 transition" 
         href="program.html"
       >
         Program
       </a>
       <a 
         class="hover:text-green-300 transition" 
         href="berita.html"
       >
         Berita
       </a>
       <a 
         class="hover:text-green-300 transition" 
         href="artikel.html"
       >
         Artikel
       </a>
       <a 
       aria-current="page"
         class="hover:text-green-300 transition"
       href="galeri.html"
     >
       Galeri
     </a>
       <a 
         class="hover:text-green-300 transition" 
         href="kontak.html"
       >
         Kontak
       </a>
       <a 
       class="hover:text-green-300 transition" 
       href="jurnal.html"
     >
       Jurnal
     </a>
      </nav>
      <button
       aria-label="Toggle menu"
       class="md:hidden focus:outline-none focus:ring-2 focus:ring-green-300"
       id="menu-btn"
      >
       <i class="fas fa-bars text-2xl text-green-100"></i>
      </button>
     </div>
    </div>
    <nav
     aria-label="Mobile menu"
     class="md:hidden bg-green-800 border-t border-green-700 hidden"
     id="mobile-menu"
    >
     <a
      class="block px-4 py-3 border-b border-green-700 text-green-100 font-semibold hover:bg-green-700"
      href="index.html"
     >
      Beranda
     </a>
     <a
      class="block px-4 py-3 border-b border-green-700 text-green-100 font-semibold hover:bg-green-700"
      href="tentang.html"
     >
      Tentang Kami
     </a>
     <a
      class="block px-4 py-3 border-b border-green-700 text-green-100 font-semibold hover:bg-green-700"
      href="program.html"
     >
      Program
     </a>
     <a
      class="block px-4 py-3 border-b border-green-700 text-green-100 font-semibold hover:bg-green-700"
      href="berita.html"
     >
      Berita
     </a>
     <a
      class="block px-4 py-3 border-b border-green-700 text-green-100 font-semibold hover:bg-green-700"
      href="artikel.html"
     >
      Artikel
     </a>
     <a
class="block px-4 py-3 border-b border-green-700 text-green-100 font-semibold hover:bg-green-700"
     href="galeri.html"
    >
     Galeri
    </a>
     <a
      class="block px-4 py-3 border-b border-green-700 text-green-100 font-semibold hover:bg-green-700"
      href="kontak.html"
     >
      Kontak
     </a>
     <a
      class="block px-4 py-3 border-b border-green-700 text-green-100 font-semibold hover:bg-green-700"
      href="jurnal.html"
     >
      Jurnal
     </a>
    </nav>
   </header>
  <script>
    const btn = document.getElementById("menu-btn");
    const menu = document.getElementById("mobile-menu");

    btn.addEventListener("click", () => {
      menu.classList.toggle("hidden");
    });
  </script>
  <main
    class="pt-20 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 bg-white min-h-screen"
  >
   <h1 class="text-4xl font-bold text-green-800 mb-12 text-center">Berita PCNU Kotabaru</h1>
   <div id="news-container" class="space-y-10"></div>
   <div class="pagination flex justify-center items-center mt-12 space-x-3">
      <button
        id="prev-btn"
        class="page-button bg-green-700 text-white px-4 py-2 rounded-md shadow hover:bg-green-800 disabled:bg-green-300 disabled:cursor-not-allowed hover-button"
        type="button"
        aria-label="Halaman sebelumnya"
      >
        <i class="fas fa-chevron-left mr-1"></i> Sebelumnya
      </button>
      <div id="page-info" class="page-info text-green-800 font-semibold"></div>
      <button
        id="next-btn"
        class="page-button bg-green-700 text-white px-4 py-2 rounded-md shadow hover:bg-green-800 disabled:bg-green-300 disabled:cursor-not-allowed hover-button"
        type="button"
        aria-label="Halaman berikutnya"
      >
        Berikutnya <i class="fas fa-chevron-right ml-1"></i>
      </button>
    </div>
  </main>

  <!-- Modal -->
  <div
    id="modal"
    class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50"
    role="dialog"
    aria-modal="true"
    aria-labelledby="modal-title"
  >
   <div
     class="bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-lg relative p-6"
   >
    <button
      id="modal-close"
      aria-label="Tutup modal"
      class="absolute top-3 right-3 text-gray-600 hover:text-gray-900 focus:outline-none"
    >
     <i class="fas fa-times text-2xl"></i>
    </button>
    <h2 id="modal-title" class="text-3xl font-bold text-green-800 mb-4"></h2>
    <div class="mb-2 text-sm text-green-700 font-semibold" id="modal-meta"></div>
    <div id="modal-content" class="text-gray-700 whitespace-pre-wrap"></div>
   </div>
  </div>

  <footer class="bg-green-800 text-green-100 py-8 mt-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid md:grid-cols-2 gap-8">
        <div>
          <h3 class="text-xl font-bold mb-4">PCNU Kotabaru</h3>
          <p class="mb-2" style="display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-map-marker-alt"></i>
            Alamat: Jl. Mega Indah RT. 07 Ds. Semayap, Komplek Pendidikan Darul Ulum Kotabaru
          </p>
          <p class="mb-2" style="display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-envelope"></i>
            Email: kotabaru@nu.or.id
          </p>
          <p class="mb-2" style="display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-phone"></i>
            Telp: (+62) 812-5656-8899, (+62) 812-5063-356
          </p>
        </div>

        <div>
          <h3 class="text-xl font-bold mb-4">Media Sosial</h3>
          <div style="display: flex; gap: 1rem;">
            <a href="#" class="text-green-100 hover:text-green-300 transition social-icon" style="font-size: 1.5rem;">
              <i class="fab fa-facebook"></i>
            </a>
            <a href="#" class="text-green-100 hover:text-green-300 transition social-icon" style="font-size: 1.5rem;">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="text-green-100 hover:text-green-300 transition social-icon" style="font-size: 1.5rem;">
              <i class="fab fa-instagram"></i>
            </a>
            <a href="#" class="text-green-100 hover:text-green-300 transition social-icon" style="font-size: 1.5rem;">
              <i class="fab fa-youtube"></i>
            </a>
          </div>
        </div>
      </div>
      <div class="mt-8 pt-4 border-t border-green-700 text-center">
        <p>&copy; 2024 PCNU Kotabaru. Semua hak cipta dilindungi undang-undang.</p>
      </div>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
      // Inisialisasi Supabase client
      const supabaseUrl = 'https://iwnwqcxigtywetgcmlou.supabase.co'
      const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml3bndxY3hpZ3R5d2V0Z2NtbG91Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU4MjQ4MTUsImV4cCI6MjA1MTQwMDgxNX0.fjdJlTVav4Gm8ku9rBmRuLoae5ViFxas7Uu069ItfnY'
      const supabase = window.supabase.createClient(supabaseUrl, supabaseKey)

    const newsContainer = document.getElementById("news-container");
    const modal = document.getElementById("modal");
    const modalTitle = document.getElementById("modal-title");
    const modalMeta = document.getElementById("modal-meta");
    const modalContent = document.getElementById("modal-content");
    const modalCloseBtn = document.getElementById("modal-close");

    const itemsPerPage = 5;
    let currentPage = 1;
    let newsData = [];
    let totalPages = 0;

    function formatDate(dateStr) {
      const options = { year: "numeric", month: "long", day: "numeric" };
      const date = new Date(dateStr);
      return date.toLocaleDateString("id-ID", options);
    }

    async function fetchNews() {
      try {
        const { data, error } = await supabase
          .from('berita')
          .select('*')
          .order('tanggal', { ascending: false });

        if (error) throw error;

        newsData = data;
        totalPages = Math.ceil(newsData.length / itemsPerPage);
        updatePage();
      } catch (error) {
        console.error('Error:', error);
        newsContainer.innerHTML = `
          <div class="text-center text-red-600">
            Terjadi kesalahan saat mengambil data berita.
          </div>
        `;
      }
    }

    function renderNewsPage(page) {
      newsContainer.innerHTML = "";
      const start = (page - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageItems = newsData.slice(start, end);

      if (pageItems.length === 0) {
        newsContainer.innerHTML = `
          <div class="text-center text-gray-600">
            Tidak ada berita yang ditemukan.
          </div>
        `;
        return;
      }

      pageItems.forEach((item, index) => {
        const article = document.createElement("article");
        article.className = "bg-green-50 rounded-lg shadow-md p-6 news-card";

        // Strip HTML tags for preview text, then truncate
        const tempDiv = document.createElement("div");
        tempDiv.innerHTML = item.konten;
        let textContent = tempDiv.textContent || tempDiv.innerText || "";
        if (textContent.length > 250) {
          textContent = textContent.slice(0, 250) + "...";
        }

        article.innerHTML = `
          <h2 class="text-2xl font-semibold text-green-700 mb-2">${item.judul}</h2>
          <div class="mb-2 flex flex-wrap gap-4 text-sm text-green-800 font-semibold">
            <span class="bg-green-200 rounded-full px-3 py-1">${item.kategori}</span>
            <span>Penulis: ${item.penulis}</span>
            <span>Tanggal: ${formatDate(item.tanggal)}</span>
          </div>
          ${item.gambar_url ? `<img src="${item.gambar_url}" alt="${item.judul}" class="w-full h-48 object-cover rounded-lg mb-4">` : ''}
          <p class="text-gray-700 text-justify mb-4">${textContent}</p>
          <button
            class="bg-green-700 text-white px-4 py-2 rounded-md hover:bg-green-800 transition font-semibold hover-button"
            data-news-index="${start + index}"
            aria-label="Baca selengkapnya berita ${item.judul}"
          >
            Baca Selengkapnya
          </button>
        `;
        newsContainer.appendChild(article);
      });
    }

    function renderPagination() {
      document.getElementById('page-info').textContent = `${currentPage} dari ${totalPages}`;
      document.getElementById('prev-btn').disabled = currentPage === 1;
      document.getElementById('next-btn').disabled = currentPage === totalPages;
    }

    function previousPage() {
      if (currentPage > 1) {
        currentPage--;
        updatePage();
        window.scrollTo({ top: 0, behavior: "smooth" });
      }
    }

    function nextPage() {
      if (currentPage < totalPages) {
        currentPage++;
        updatePage();
        window.scrollTo({ top: 0, behavior: "smooth" });
      }
    }

    function updatePage() {
      renderNewsPage(currentPage);
      renderPagination();
      attachReadMoreListeners();
    }

    function attachReadMoreListeners() {
      const buttons = newsContainer.querySelectorAll("button[data-news-index]");
      buttons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const index = parseInt(btn.getAttribute("data-news-index"));
          openModal(index);
        });
      });
    }

    function openModal(index) {
      const article = newsData[index];
      modalTitle.textContent = article.judul;
      modalMeta.textContent = `Kategori: ${article.kategori} | Penulis: ${article.penulis} | Tanggal: ${formatDate(article.tanggal)}`;
      
      // Tambahkan gambar di atas judul jika tersedia
      let contentHTML = '';
      if (article.gambar_url) {
        contentHTML += `<img src="${article.gambar_url}" alt="${article.judul}" class="w-full rounded-lg mb-6">`;
      }
      contentHTML += article.konten;
      
      modalContent.innerHTML = contentHTML;
      modal.classList.remove("hidden");
      document.body.style.overflow = "hidden";
    }

    function closeModal() {
      modal.classList.add("hidden");
      document.body.style.overflow = "";
    }

    modalCloseBtn.addEventListener("click", closeModal);
    modal.addEventListener("click", (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && !modal.classList.contains("hidden")) {
        closeModal();
      }
    });

    // Event listeners
    document.getElementById('prev-btn').addEventListener('click', previousPage);
    document.getElementById('next-btn').addEventListener('click', nextPage);

    // Initial load
    fetchNews();
  </script>
 </body>
</html>
